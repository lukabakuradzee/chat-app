{"ast":null,"code":"import jwtDecode from 'jwt-decode'; // Ensure correct import\nimport { AUTHENTICATE, LOG_IN, LOG_OUT, UPDATE_USER_PROFILE } from './constants';\nimport { toggleLocalStorage } from '../../utils/jwt';\nconst initialState = {\n  isAuthenticated: false,\n  user: null\n};\nconst reducer = (state = initialState, action) => {\n  const {\n    type,\n    payload\n  } = action;\n  switch (type) {\n    case LOG_IN:\n      {\n        try {\n          if (payload !== null && payload !== void 0 && payload.token) {\n            // Check if token exists in payload\n            const {\n              token,\n              refreshToken\n            } = payload;\n            const user = jwtDecode(token);\n            toggleLocalStorage(token, refreshToken);\n            return {\n              isAuthenticated: true,\n              user\n            };\n          } else {\n            console.error('Payload missing token');\n            return state;\n          }\n        } catch (error) {\n          console.error('Error decoding token: ', error);\n          return state;\n        }\n      }\n    case LOG_OUT:\n      {\n        toggleLocalStorage();\n        return {\n          isAuthenticated: false,\n          user: null\n        };\n      }\n    case AUTHENTICATE:\n      {\n        try {\n          if (payload) {\n            // Check if payload exists\n            const user = jwtDecode(payload);\n            return {\n              isAuthenticated: true,\n              user\n            };\n          } else {\n            console.error('Payload missing');\n            return state;\n          }\n        } catch (error) {\n          console.error('Error decoding token: ', error);\n          return state;\n        }\n      }\n    case UPDATE_USER_PROFILE:\n      {\n        try {\n          if (payload) {\n            // Check if payload exists\n            const updatedUser = {\n              ...state.user,\n              ...payload\n            };\n            localStorage.setItem('user', JSON.stringify(updatedUser));\n            console.log('Reducer Payload : ', updatedUser);\n            return {\n              ...state,\n              user: updatedUser\n            };\n          } else {\n            console.error('Payload missing');\n            return state;\n          }\n        } catch (error) {\n          console.error('Error updating user: ', error);\n          return state;\n        }\n      }\n    default:\n      return state;\n  }\n};\nexport { initialState, reducer };","map":{"version":3,"names":["jwtDecode","AUTHENTICATE","LOG_IN","LOG_OUT","UPDATE_USER_PROFILE","toggleLocalStorage","initialState","isAuthenticated","user","reducer","state","action","type","payload","token","refreshToken","console","error","updatedUser","localStorage","setItem","JSON","stringify","log"],"sources":["/Users/macintoshi/Desktop/chat-app/chat-app/src/context/auth/reducer.js"],"sourcesContent":["import jwtDecode from 'jwt-decode'; // Ensure correct import\nimport {\n  AUTHENTICATE,\n  LOG_IN,\n  LOG_OUT,\n  UPDATE_USER_PROFILE,\n} from './constants';\nimport { toggleLocalStorage } from '../../utils/jwt';\n\nconst initialState = {\n  isAuthenticated: false,\n  user: null,\n};\n\nconst reducer = (state = initialState, action) => {\n  const { type, payload } = action;\n  switch (type) {\n    case LOG_IN: {\n      try {\n        if (payload?.token) { // Check if token exists in payload\n          const { token, refreshToken } = payload;\n          const user = jwtDecode(token);\n          toggleLocalStorage(token, refreshToken);\n          return { isAuthenticated: true, user };\n        } else {\n          console.error('Payload missing token');\n          return state;\n        }\n      } catch (error) {\n        console.error('Error decoding token: ', error);\n        return state;\n      }\n    }\n    case LOG_OUT: {\n      toggleLocalStorage();\n      return { isAuthenticated: false, user: null };\n    }\n    case AUTHENTICATE: {\n      try {\n        if (payload) { // Check if payload exists\n          const user = jwtDecode(payload);\n          return { isAuthenticated: true, user };\n        } else {\n          console.error('Payload missing');\n          return state;\n        }\n      } catch (error) {\n        console.error('Error decoding token: ', error);\n        return state;\n      }\n    }\n    case UPDATE_USER_PROFILE: {\n      try {\n        if (payload) { // Check if payload exists\n          const updatedUser = { ...state.user, ...payload };\n          localStorage.setItem('user', JSON.stringify(updatedUser));\n          console.log('Reducer Payload : ', updatedUser);\n          return { ...state, user: updatedUser };\n        } else {\n          console.error('Payload missing');\n          return state;\n        }\n      } catch (error) {\n        console.error('Error updating user: ', error);\n        return state;\n      }\n    }\n    default:\n      return state;\n  }\n};\n\nexport { initialState, reducer };\n"],"mappings":"AAAA,OAAOA,SAAS,MAAM,YAAY,CAAC,CAAC;AACpC,SACEC,YAAY,EACZC,MAAM,EACNC,OAAO,EACPC,mBAAmB,QACd,aAAa;AACpB,SAASC,kBAAkB,QAAQ,iBAAiB;AAEpD,MAAMC,YAAY,GAAG;EACnBC,eAAe,EAAE,KAAK;EACtBC,IAAI,EAAE;AACR,CAAC;AAED,MAAMC,OAAO,GAAGA,CAACC,KAAK,GAAGJ,YAAY,EAAEK,MAAM,KAAK;EAChD,MAAM;IAAEC,IAAI;IAAEC;EAAQ,CAAC,GAAGF,MAAM;EAChC,QAAQC,IAAI;IACV,KAAKV,MAAM;MAAE;QACX,IAAI;UACF,IAAIW,OAAO,aAAPA,OAAO,eAAPA,OAAO,CAAEC,KAAK,EAAE;YAAE;YACpB,MAAM;cAAEA,KAAK;cAAEC;YAAa,CAAC,GAAGF,OAAO;YACvC,MAAML,IAAI,GAAGR,SAAS,CAACc,KAAK,CAAC;YAC7BT,kBAAkB,CAACS,KAAK,EAAEC,YAAY,CAAC;YACvC,OAAO;cAAER,eAAe,EAAE,IAAI;cAAEC;YAAK,CAAC;UACxC,CAAC,MAAM;YACLQ,OAAO,CAACC,KAAK,CAAC,uBAAuB,CAAC;YACtC,OAAOP,KAAK;UACd;QACF,CAAC,CAAC,OAAOO,KAAK,EAAE;UACdD,OAAO,CAACC,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;UAC9C,OAAOP,KAAK;QACd;MACF;IACA,KAAKP,OAAO;MAAE;QACZE,kBAAkB,CAAC,CAAC;QACpB,OAAO;UAAEE,eAAe,EAAE,KAAK;UAAEC,IAAI,EAAE;QAAK,CAAC;MAC/C;IACA,KAAKP,YAAY;MAAE;QACjB,IAAI;UACF,IAAIY,OAAO,EAAE;YAAE;YACb,MAAML,IAAI,GAAGR,SAAS,CAACa,OAAO,CAAC;YAC/B,OAAO;cAAEN,eAAe,EAAE,IAAI;cAAEC;YAAK,CAAC;UACxC,CAAC,MAAM;YACLQ,OAAO,CAACC,KAAK,CAAC,iBAAiB,CAAC;YAChC,OAAOP,KAAK;UACd;QACF,CAAC,CAAC,OAAOO,KAAK,EAAE;UACdD,OAAO,CAACC,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;UAC9C,OAAOP,KAAK;QACd;MACF;IACA,KAAKN,mBAAmB;MAAE;QACxB,IAAI;UACF,IAAIS,OAAO,EAAE;YAAE;YACb,MAAMK,WAAW,GAAG;cAAE,GAAGR,KAAK,CAACF,IAAI;cAAE,GAAGK;YAAQ,CAAC;YACjDM,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEC,IAAI,CAACC,SAAS,CAACJ,WAAW,CAAC,CAAC;YACzDF,OAAO,CAACO,GAAG,CAAC,oBAAoB,EAAEL,WAAW,CAAC;YAC9C,OAAO;cAAE,GAAGR,KAAK;cAAEF,IAAI,EAAEU;YAAY,CAAC;UACxC,CAAC,MAAM;YACLF,OAAO,CAACC,KAAK,CAAC,iBAAiB,CAAC;YAChC,OAAOP,KAAK;UACd;QACF,CAAC,CAAC,OAAOO,KAAK,EAAE;UACdD,OAAO,CAACC,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;UAC7C,OAAOP,KAAK;QACd;MACF;IACA;MACE,OAAOA,KAAK;EAChB;AACF,CAAC;AAED,SAASJ,YAAY,EAAEG,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}